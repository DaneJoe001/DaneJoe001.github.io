# USART串口通信交互工具

![版本](https://img.shields.io/badge/版本-1.0.0-blue)
![Qt版本](https://img.shields.io/badge/Qt-6.9.1-green)
![C++标准](https://img.shields.io/badge/C++-17-orange)
![平台](https://img.shields.io/badge/平台-Windows-lightgrey)

## 项目简介

这是一个基于Qt框架开发的串口(USART)通信工具，提供友好的图形界面，支持多种串口参数配置，方便进行串口设备的调试和数据交互。

本项目作为练手使用，界面通过纯cpp代码构建，实际功能有待完善。

## 功能特点

- **直观的图形界面**：清晰的布局设计，使用户可以轻松操作
- **串口参数配置**：支持配置波特率、数据位、停止位、校验位和流控制
- **实时数据显示**：接收和发送的数据实时显示在文本浏览器中
- **数据发送功能**：支持文本数据编辑和发送
- **端口管理**：自动检测可用串口，支持刷新端口列表
- **数据清除功能**：一键清空输入输出窗口
- **单例模式设计**：保证串口资源的唯一性和安全性

## 技术架构

### 使用的技术栈

- **C++17**：采用现代C++特性
- **Qt 6.9**：使用Qt框架进行GUI开发
- **CMake**：项目构建系统
- **Qt Serial Port**：用于串口通信

### 设计模式与技术特点

- **单例模式**：BaseUsart类采用单例设计，确保全局只有一个串口通信实例
- **回调函数**：使用std::function实现数据收发回调，提高代码灵活性
- **信号槽机制**：利用Qt信号槽实现GUI与串口通信的松耦合
- **QSerialPort**：封装底层串口操作，简化通信实现
- **基于事件的异步通信**：避免阻塞UI线程

### 项目结构

```
cpp_usart_interaction/
├── include/                # 头文件目录
│   ├── base_usart.hpp      # 基础串口通信类
│   └── window_main.hpp     # 主窗口类
├── source/                 # 源代码目录
│   ├── main.cpp            # 程序入口
│   ├── base_usart.cpp      # 串口通信实现
│   └── window_main.cpp     # 主窗口实现
├── resource/               # 资源文件
│   └── usart_icon.ico      # 应用图标
├── CMakeLists.txt          # CMake配置文件
└── README.md               # 项目说明文档
```

## 类设计

### BaseUsart类

串口通信的核心类，采用单例模式设计，主要功能包括：

- 获取可用串口列表
- 设置当前串口参数
- 打开/关闭串口
- 发送/接收数据
- 串口状态管理

#### 关键方法

```cpp
// 获取单例实例
static BaseUsart& get_instance();

// 获取可用串口列表
QList<QSerialPortInfo>& get_port_list();

// 发送数据
void send_data(const QByteArray& data);

// 接收指定大小的数据
QByteArray receive_data(quint16 size);

// 打开串口
void open_port();
```

### WindowMain类

主窗口界面类，负责用户交互和界面展示，主要功能包括：

- 图形界面布局
- 串口参数配置控件
- 数据发送接收显示
- 用户操作响应
- 信号槽连接

#### 界面设计

窗口布局采用嵌套的布局管理器实现：
- 主布局使用QVBoxLayout垂直布局
- 上部区域为QTextBrowser文本浏览器
- 下部区域分为左侧输入区和右侧控制区
- 右侧控制区按功能分组，使用QHBoxLayout水平布局

#### 信号与槽

```cpp
// 重要信号
signals:
    void data_received_signal(const QString& sender, const QString& data);
    
// 重要槽函数
public slots:
    void out_put_text_browser_append(const QString& sender, const QString& str);
    void on_push_button_port_open_or_close_clicked();
    void on_push_button_port_send_clicked();
    void data_received();
```

## 环境要求

- **操作系统**：Windows 10/11
- **编译器**：
  - MSVC 2022 或更高版本
  - MinGW-w64 (支持C++17)
- **Qt环境**：Qt 6.9.1 或更高版本
- **CMake**：3.16 或更高版本


## 使用指南

### 基本操作流程

1. **启动应用**：运行编译好的可执行文件
2. **选择串口**：从下拉列表中选择要使用的串口
3. **配置参数**：设置波特率、数据位、停止位、校验位和流控制
4. **打开串口**：点击"打开端口"按钮
5. **发送数据**：在文本编辑框中输入要发送的数据，点击"发送"按钮
6. **查看数据**：接收和发送的数据会显示在上方的文本浏览器中

### 界面说明

应用界面主要分为三个部分：

- **上部区域**：文本浏览器，用于显示发送和接收的数据
- **左下区域**：文本编辑框，用于输入要发送的数据
- **右下区域**：串口配置和操作按钮

### 参数配置说明

1. **波特率**：支持常见波特率选择（9600, 19200, 38400, 57600, 115200等）
2. **数据位**：支持5-8位数据位配置
3. **校验位**：支持无校验、奇校验、偶校验等多种模式
4. **停止位**：支持1位、1.5位或2位停止位
5. **流控制**：支持无流控制、硬件流控制和软件流控制

### 实用技巧

- **刷新端口**：如果接入新设备后未显示，可点击"刷新"按钮更新端口列表
- **清空显示**：数据量大时可点击"清空输出"按钮清空历史记录
- **数据格式**：文本编辑框支持直接输入ASCII文本

## 开发计划与展望

### 近期计划

- [ ] 添加十六进制数据显示模式
- [ ] 支持数据记录与日志保存功能
- [ ] 增加自动发送功能（定时发送）
- [ ] 实现接收数据过滤功能

## 联系方式

如有任何问题或建议，请通过以下方式联系我：

- 项目主页：[https://github.com/DaneJoe001/cpp_usart_tool](https://github.com/DaneJoe001/cpp_usart_tool)
- 电子邮件：[2469463883@qq.com]

## 开发心得

### 技术挑战与解决方案

在开发过程中遇到了一些技术挑战，以下是解决这些挑战的方法：

1. **串口数据接收问题**：使用Qt的事件驱动机制，实现了无阻塞的数据接收
2. **GUI响应性能**：通过信号槽机制分离UI和串口操作，保证界面响应流畅
3. **跨平台兼容**：基于Qt框架实现，减少平台相关代码，便于日后扩展

### 设计经验分享

1. **单例模式的应用**：串口资源是独占的，使用单例模式可有效避免资源冲突
2. **模块化设计**：将串口操作与界面分离，便于维护和扩展
3. **布局管理**：使用Qt的嵌套布局，实现了响应式界面设计

## 致谢

感谢Qt社区提供的优秀框架和工具，以及所有为本项目提供帮助和建议的朋友们。特别感谢在开发过程中给予指导和支持的同事与老师。

---
